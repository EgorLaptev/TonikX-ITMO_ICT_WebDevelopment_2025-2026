# Архитектура приложения

Описание архитектуры и структуры Vue 3 приложения для системы управления отелем.

## Общая архитектура

Приложение построено по компонентной архитектуре Vue 3 с использованием Composition API. Применяется принцип разделения ответственности между компонентами, сервисами и маршрутизацией.

## Структура проекта

```
laboratory_work_4/
├── public/                 # Статические файлы
│   └── favicon.ico
├── src/
│   ├── views/             # Компоненты страниц (views)
│   │   ├── Home.vue       # Главная страница
│   │   ├── Login.vue      # Страница авторизации
│   │   ├── Register.vue   # Страница регистрации
│   │   └── Profile.vue    # Страница профиля
│   ├── router/            # Маршрутизация
│   │   └── index.js       # Конфигурация Vue Router
│   ├── services/          # Сервисы для работы с API
│   │   └── api.js         # Axios конфигурация и API методы
│   ├── App.vue            # Корневой компонент приложения
│   └── main.js            # Точка входа приложения
├── docs/                  # Документация MkDocs
│   ├── interfaces/        # Документация интерфейсов
│   ├── index.md
│   ├── api-integration.md
│   └── architecture.md
├── index.html             # HTML шаблон
├── package.json           # Зависимости проекта
├── vite.config.js         # Конфигурация Vite
├── mkdocs.yml            # Конфигурация MkDocs
└── README.md             # Документация проекта
```

## Основные компоненты

### App.vue

Корневой компонент приложения, содержит:

- **v-app** - основной компонент Vuetify
- **v-app-bar** - навигационная панель (отображается для авторизованных пользователей)
- **v-main** - основной контент с router-view
- Логику определения авторизации пользователя

**Особенности:**
- Динамическое отображение навигационной панели
- Определение статуса аутентификации через computed свойства

### Views (Компоненты страниц)

#### Home.vue

Главная страница приложения, доступная только авторизованным пользователям.

**Функциональность:**
- Приветственное сообщение
- Навигация к профилю
- Кнопка выхода из системы

#### Login.vue

Страница авторизации пользователей.

**Функциональность:**
- Форма входа (username, password)
- Валидация полей
- Обработка ошибок авторизации
- Сохранение токена в localStorage
- Перенаправление на главную страницу после успешного входа
- Ссылка на страницу регистрации

#### Register.vue

Страница регистрации новых пользователей.

**Функциональность:**
- Форма регистрации (username, email, password, confirmPassword)
- Валидация всех полей
- Проверка совпадения паролей
- Обработка ошибок регистрации
- Отображение сообщения об успехе
- Автоматическое перенаправление на страницу входа
- Ссылка на страницу входа

#### Profile.vue

Страница управления профилем пользователя.

**Функциональность:**
- Вкладка "Профиль":
  - Просмотр и редактирование username и email
  - Валидация полей
  - Обновление профиля через API
- Вкладка "Изменение пароля":
  - Изменение пароля учетной записи
  - Валидация полей пароля
  - Проверка совпадения паролей
- Автоматическая загрузка данных пользователя при монтировании
- Обработка ошибок для обеих операций

## Маршрутизация

### Router (router/index.js)

Конфигурация Vue Router с защитой маршрутов.

**Маршруты:**
- `/` - Home (requiresAuth: true)
- `/login` - Login (requiresGuest: true)
- `/register` - Register (requiresGuest: true)
- `/profile` - Profile (requiresAuth: true)

**Navigation Guards:**
- `beforeEach` - проверяет наличие токена для защищенных маршрутов
- Автоматическое перенаправление неавторизованных пользователей на `/login`
- Автоматическое перенаправление авторизованных пользователей с `/login` и `/register` на `/`

## Сервисы

### API Service (services/api.js)

Централизованный сервис для взаимодействия с Django REST Framework API.

**Функциональность:**
- Создание экземпляра Axios с базовой конфигурацией
- Request Interceptor для автоматического добавления токена
- Response Interceptor для обработки ошибок 401
- Методы API для аутентификации и управления профилем

**API методы:**
- `authAPI.login(username, password)`
- `authAPI.logout()`
- `authAPI.register(username, password, email)`
- `authAPI.getCurrentUser()`
- `authAPI.updateUser(data)`
- `authAPI.changePassword(currentPassword, newPassword)`

## Состояние приложения

Текущая архитектура не использует централизованное управление состоянием (Vuex/Pinia). Вместо этого:

- Токен авторизации хранится в `localStorage`
- Статус аутентификации определяется через проверку наличия токена
- Данные пользователя загружаются по требованию через API

### Преимущества текущего подхода:
- Простота реализации для небольших приложений
- Меньше зависимостей
- Легче понять и поддерживать

### Возможные улучшения:
- Добавление Vuex/Pinia для централизованного управления состоянием
- Кеширование данных пользователя
- Оптимистичные обновления UI

## Стилизация

### Vuetify 3

Приложение использует Vuetify 3 для Material Design компонентов.

**Основные компоненты:**
- `v-app`, `v-app-bar`, `v-main` - структура приложения
- `v-container`, `v-row`, `v-col` - сетка
- `v-card`, `v-card-text`, `v-card-actions` - карточки
- `v-form`, `v-text-field` - формы
- `v-btn` - кнопки
- `v-alert` - уведомления
- `v-tabs`, `v-tab`, `v-window` - вкладки

**Тема:**
- Светлая тема по умолчанию
- Основной цвет: blue
- Поддержка темной темы (через Vuetify)

## Валидация форм

Все формы используют встроенную валидацию Vuetify через правила валидации.

**Подход:**
- Правила валидации определены как функции
- Валидация происходит в реальном времени
- Сообщения об ошибках отображаются под полями
- Кнопки отправки формы блокируются при невалидных данных

**Пример правил:**
```javascript
const usernameRules = [
  (v) => !!v || 'Имя пользователя обязательно',
  (v) => (v && v.length >= 3) || 'Минимум 3 символа',
]
```

## Обработка ошибок

### Стратегия обработки ошибок:

1. **На уровне API:**
   - Response Interceptor обрабатывает 401 ошибки
   - Автоматическое перенаправление на страницу входа

2. **На уровне компонентов:**
   - Try-catch блоки для обработки ошибок запросов
   - Отображение пользователю понятных сообщений об ошибках
   - Извлечение конкретных ошибок из ответа сервера

3. **Отображение ошибок:**
   - Компонент `v-alert` с типом `error`
   - Конкретные сообщения для каждого типа ошибки

## Безопасность

### Реализованные меры:

1. **Токен авторизации:**
   - Хранится в localStorage
   - Автоматически добавляется к каждому запросу
   - Удаляется при выходе или ошибке 401

2. **Защита маршрутов:**
   - Navigation guards проверяют аутентификацию
   - Автоматическое перенаправление для неавторизованных пользователей

3. **Валидация:**
   - Клиентская валидация для улучшения UX
   - Серверная валидация (на Django) для безопасности

4. **CORS:**
   - Настроено на стороне Django сервера
   - Разрешены запросы с localhost:5173 (в разработке)

## Развертывание

### Development

```bash
npm install
npm run dev
```

Приложение запускается на `http://localhost:5173`

### Production

```bash
npm run build
```

Собранные файлы находятся в папке `dist/`

### Интеграция с Django

В production окружении необходимо:

1. Настроить сборку статических файлов
2. Настроить CORS для домена frontend приложения
3. Настроить проксирование или сервер для раздачи статических файлов
4. Обновить `API_BASE_URL` в `api.js` на production URL

## Будущие улучшения

1. **Управление состоянием:**
   - Интеграция Pinia для централизованного состояния

2. **Оптимизация:**
   - Lazy loading компонентов
   - Code splitting
   - Оптимизация изображений

3. **Функциональность:**
   - Управление отелем (номера, гости, бронирования)
   - Панель администратора
   - Уведомления в реальном времени

4. **Тестирование:**
   - Unit тесты для компонентов
   - E2E тесты
   - Тесты API интеграции

5. **UX улучшения:**
   - Загрузочные индикаторы
   - Skeleton screens
   - Toast уведомления



