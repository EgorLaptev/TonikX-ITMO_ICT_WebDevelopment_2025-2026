# Интерфейс управления проживаниями

Интерфейс для управления проживаниями гостей в номерах отеля с возможностью просмотра сводки.

## Описание

Компонент `Stays.vue` предоставляет полный CRUD функционал для управления проживаниями, включая создание, редактирование, удаление и просмотр сводки по проживаниям на определенную дату.

## Расположение

Компонент находится в файле `src/views/Stays.vue`

## Маршрут

- **URL:** `/stays`
- **Маршрут:** `Stays`
- **Мета:** `requiresAuth: true` - доступен только авторизованным пользователям

## Функциональность

### Основные операции

1. **Просмотр списка** - отображение всех проживаний в таблице
2. **Создание** - добавление нового проживания
3. **Редактирование** - изменение существующего проживания
4. **Удаление** - удаление проживания с подтверждением
5. **Сводка** - просмотр сводки по проживаниям на определенную дату

### Поля формы

1. **Гость (guest_id)**
   - Тип: выбор из списка
   - Обязательное поле
   - Правила валидации: должен быть выбран гость

2. **Номер (room_id)**
   - Тип: выбор из списка
   - Обязательное поле
   - Правила валидации: должен быть выбран номер

3. **Дата заезда (check_in)**
   - Тип: дата
   - Обязательное поле
   - Правила валидации: поле должно быть заполнено, дата не может быть в прошлом

4. **Дата выезда (check_out)**
   - Тип: дата
   - Обязательное поле
   - Правила валидации: поле должно быть заполнено, дата должна быть позже даты заезда

### Сводка

Интерфейс предоставляет функцию просмотра сводки, которая показывает для выбранной даты:

- Дата сводки
- Всего проживаний
- Активных сейчас (проживания, которые активны на выбранную дату)
- Предстоящих (проживания с датой заезда после выбранной даты)
- Активных номеров (количество уникальных номеров с активными проживаниями)

### Валидация

Форма использует встроенную валидацию Vuetify с правилами:

- `guest_id`: проверка выбора гостя
- `room_id`: проверка выбора номера
- `check_in`: проверка наличия значения
- `check_out`: проверка наличия значения

На сервере также выполняется проверка:
- Дата заезда не может быть в прошлом
- Дата выезда должна быть позже даты заезда
- Номер не должен быть занят на выбранные даты

### API Endpoints

**GET** `/api/stays/` - Получение списка проживаний

**GET** `/api/stays/{id}/` - Получение конкретного проживания

**POST** `/api/stays/` - Создание нового проживания

**PUT** `/api/stays/{id}/` - Обновление проживания

**PATCH** `/api/stays/{id}/` - Частичное обновление проживания

**DELETE** `/api/stays/{id}/` - Удаление проживания

**GET** `/api/stays/summary/?date=YYYY-MM-DD` - Получение сводки по проживаниям

### Пример запроса создания

```json
{
  "guest_id": 1,
  "room_id": 1,
  "check_in": "2024-01-15",
  "check_out": "2024-01-20"
}
```

### Пример ответа сводки

```json
{
  "date": "2024-01-18",
  "total_stays": 50,
  "active_now": 12,
  "upcoming": 8,
  "active_rooms": 10
}
```

## UI Компоненты

Интерфейс использует следующие компоненты Vuetify:

- `v-container` - контейнер с адаптивной сеткой
- `v-card` - карточка с данными
- `v-data-table` - таблица для отображения данных
- `v-dialog` - модальное окно для формы и сводки
- `v-form` - форма с валидацией
- `v-select` - выпадающие списки для выбора гостя и номера
- `v-text-field` - поля ввода даты
- `v-btn` - кнопки действий
- `v-alert` - отображение ошибок
- `v-list` - список для отображения сводки

## Обработка ошибок

Компонент обрабатывает следующие типы ошибок:

- **400 Bad Request**: Ошибки валидации данных (например, номер занят на выбранные даты, дата заезда в прошлом)
- **401 Unauthorized**: Отсутствие авторизации
- **404 Not Found**: Проживание не найдено
- **500 Internal Server Error**: Ошибка сервера

Все ошибки отображаются в виде алерта под формой.

