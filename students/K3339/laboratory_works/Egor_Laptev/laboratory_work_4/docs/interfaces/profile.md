# Интерфейс профиля пользователя

Интерфейс профиля пользователя позволяет авторизованным пользователям просматривать и изменять свои учетные данные, а также изменять пароль.

## Описание

Компонент `Profile.vue` реализует страницу профиля с двумя вкладками:
1. **Профиль** - для изменения имени пользователя и email
2. **Изменение пароля** - для изменения пароля учетной записи

## Расположение

Компонент находится в файле `src/views/Profile.vue`

## Маршрут

- **URL:** `/profile`
- **Маршрут:** `Profile`
- **Мета:** `requiresAuth: true` - доступен только авторизованным пользователям

## Функциональность

### Вкладка "Профиль"

Позволяет изменить основные данные пользователя.

#### Поля формы

1. **Имя пользователя (username)**
   - Тип: текст
   - Обязательное поле
   - Минимальная длина: 3 символа
   - Правила валидации:
     - Поле должно быть заполнено
     - Длина должна быть не менее 3 символов

2. **Email**
   - Тип: email
   - Обязательное поле
   - Правила валидации:
     - Поле должно быть заполнено
     - Должен соответствовать формату email (regex: `/.+@.+\..+/`)

#### Загрузка данных

При монтировании компонента автоматически загружаются данные текущего пользователя через GET запрос на `/auth/users/me/`.

#### Обновление профиля

При нажатии на кнопку "Сохранить изменения":

1. Проверяется валидность формы
2. Отправляется PATCH запрос на `/auth/users/me/` с данными:
   ```json
   {
     "username": "новое_имя",
     "email": "новый_email@example.com"
   }
   ```
3. При успешном ответе:
   - Отображается сообщение об успехе на 3 секунды
4. При ошибке:
   - Отображается сообщение об ошибке под формой

### Вкладка "Изменение пароля"

Позволяет изменить пароль учетной записи.

#### Поля формы

1. **Текущий пароль (currentPassword)**
   - Тип: password
   - Обязательное поле
   - Правила валидации: поле должно быть заполнено

2. **Новый пароль (newPassword)**
   - Тип: password
   - Обязательное поле
   - Минимальная длина: 8 символов
   - Правила валидации:
     - Поле должно быть заполнено
     - Длина должна быть не менее 8 символов

3. **Подтверждение нового пароля (confirmPassword)**
   - Тип: password
   - Обязательное поле
   - Правила валидации:
     - Поле должно быть заполнено
     - Должно совпадать с полем "Новый пароль"

#### Изменение пароля

При нажатии на кнопку "Изменить пароль":

1. Проверяется валидность формы
2. Проверяется совпадение нового пароля и подтверждения
3. Отправляется POST запрос на `/auth/users/set_password/` с данными:
   ```json
   {
     "current_password": "текущий_пароль",
     "new_password": "новый_пароль"
   }
   ```
4. При успешном ответе:
   - Отображается сообщение об успехе на 3 секунды
   - Форма очищается
5. При ошибке:
   - Отображается сообщение об ошибке под формой

### Обработка ошибок

Компонент обрабатывает следующие типы ошибок:

**Для профиля:**
- Ошибки валидации полей из `response.data`
- Общие ошибки обновления профиля

**Для пароля:**
- `current_password`: неверный текущий пароль
- `new_password`: ошибки валидации нового пароля
- Общие ошибки изменения пароля

### Пример использования

```vue
<template>
  <Profile />
</template>

<script setup>
import Profile from '@/views/Profile.vue'
</script>
```

### API Endpoints

#### Получение данных пользователя

**GET** `/auth/users/me/`

**Заголовки:**
```
Authorization: Token your_token_here
```

**Успешный ответ (200 OK):**
```json
{
  "id": 1,
  "username": "user",
  "email": "user@example.com"
}
```

#### Обновление профиля

**PATCH** `/auth/users/me/`

**Заголовки:**
```
Authorization: Token your_token_here
Content-Type: application/json
```

**Тело запроса:**
```json
{
  "username": "string",
  "email": "string"
}
```

**Успешный ответ (200 OK):**
```json
{
  "id": 1,
  "username": "updated_user",
  "email": "updated@example.com"
}
```

#### Изменение пароля

**POST** `/auth/users/set_password/`

**Заголовки:**
```
Authorization: Token your_token_here
Content-Type: application/json
```

**Тело запроса:**
```json
{
  "current_password": "string",
  "new_password": "string"
}
```

**Успешный ответ (204 No Content)**

**Ошибка (400 Bad Request):**
```json
{
  "current_password": ["Неверный текущий пароль."],
  "new_password": ["Этот пароль слишком короткий."]
}
```

## UI Компоненты

Интерфейс использует следующие компоненты Vuetify:

- `v-container` - контейнер с адаптивной сеткой
- `v-card` - карточка с формой
- `v-toolbar` - панель инструментов с заголовком
- `v-tabs` / `v-tab` - вкладки для переключения между профилем и паролем
- `v-window` / `v-window-item` - контейнер для содержимого вкладок
- `v-form` - форма с валидацией
- `v-text-field` - текстовые поля ввода
- `v-btn` - кнопки действий
- `v-alert` - отображение ошибок и уведомлений об успехе

## Навигация

Страница доступна только для авторизованных пользователей. При отсутствии токена происходит автоматическое перенаправление на страницу входа.

## Особенности

- Автоматическая загрузка данных пользователя при открытии страницы
- Разделение функционала на вкладки для удобства использования
- Валидация всех полей в реальном времени
- Сообщения об успешном выполнении операций с автоматическим скрытием
- Очистка формы пароля после успешного изменения
- Подробные сообщения об ошибках для каждого поля

## Безопасность

- Все запросы требуют авторизации (токен в заголовке)
- При изменении пароля требуется указать текущий пароль
- Валидация пароля на клиентской и серверной стороне
- Токен проверяется при каждом запросе



